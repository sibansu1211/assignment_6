<!DOCTYPE html>
<html>
<head>
	<title></title>
	<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
	<meta http-equiv="Pragma" content="no-cache" />
	<meta http-equiv="Expires" content="0" />
	<script src="bundle.js" type="text/javascript"></script>
</head>

<body>
	<div id="container">

	<!-- Start your code from here -->
	<main>
		<form class="form">
		<div class="info">
			<p  class="btn-top"><strong>Characters</strong> <span class="count">00</span></p>
			<p  class="btn-top"><strong>Threads</strong> <span class="threadCount">00</span></p>
		</div>
		<textarea class="textarea" placeholder="The character limit for each tweet is 275" required="" wrap="soft" onkeyup="textInfo(this);"></textarea>
		<button type="submit" class="btn">
			Thread
		</button>
		</form>

		<div class="thread-box">

		<div class="thread">
			<p>
			Your threads will be here.  <br /><br />
			The character limit for each tweet is 275. <br /><br />
			</p>
		</div>
		</div>
	</main>

	<!-- End your code -->

	</div>
	 <!-- write your javascript code here -->
	 <script>
		const dom = (s) => document.querySelector(s); //`${s}`
		const form = dom(".form");
		const strCount = dom(".count");
		const threadCount = dom(".threadCount");
		const threadBox = dom(".thread-box");
   
   
		let size = 275; 
		let tweetsArr = [];
   
   
		function textInfo(obj) {
			let length = obj.value.length;
   
			strCount.innerHTML = length;
			threadCount.innerHTML = Math.ceil(length / size);
   
			length > size ? (obj.style.color = "purple"): (obj.style.color = "seagreen");
		}
   
   
		function rightArea(listParent, arr = []) {
			listParent.innerHTML = arr
			.map((ele, i) => {
				return `
				<article class="thread" data-index="${i}">
		
				<div class="tools">
				<span class="index">${i < 9 ? '0' + (i + 1): i + 1}</span>
				<span class="close" data-index="${i}">✖️</span>
				</div>
		
				<p class="tweet">
				${ele}
				</p>
		
				</article>
				`;
			})
			.join("");
		}
   

	
	// write your javascript code here
	function tweets(str) {

		 let splitOnWhiteSpace = str.split(' ');

		 let result = [];

		 let totalLength = 0;
		 let sentence = '';

		 for (let i = 0; i < splitOnWhiteSpace.length; i++) {

			 let curWord = splitOnWhiteSpace[i];
			 let curWordLength = curWord.length;

			 sentence += curWord + ' '; 

			 totalLength += curWordLength + 1;

			 if (totalLength >= size) {

				 sentence = sentence.trim();

				 let lengthDiff = sentence.length - size;

				 if (lengthDiff > 0) {

					 let lastIndexOfWhiteSpace = sentence.lastIndexOf(' ');

					 sentence = sentence.slice(0, lastIndexOfWhiteSpace);

					 i--;
				 }
				 result.push(sentence);

				 totalLength = 0;
				 sentence = '';
			 }


			 if (i === splitOnWhiteSpace.length -1 && totalLength <= size && sentence !== '') {
				 result.push(sentence.trim());
			 }
		 }

		 return result;

	 }


	 function thread(e) {
		 e.preventDefault();

		 const thread = dom(".thread");
		 tweetsArr = tweets(dom(".textarea").value);

		 rightArea(threadBox, tweetsArr);
	 }


	 form.addEventListener("submit", thread);


	 /////////////////////////////////////

	 function deleteThread(e) {
		 const [ele,index] = [e.target,e.target.dataset.index];
		 let txt = e.target.dataset.para;

		 if (ele.classList.contains("close")) {

			 tweetsArr.splice(index, 1);

			 rightArea(threadBox, tweetsArr);
		 }

		 if (ele.classList.contains("copy")) {

		 }
	 }

	 threadBox.addEventListener("click", deleteThread);
	
	
	

	</script>

</body>
<script>
/* DO NOT EDIT THIS CODE- WRITTERN TO PREVENT CSS CACHING */	  
	// Get HTML head element
	var head = document.getElementsByTagName('HEAD')[0]; 
	// Create new link Element
	var link = document.createElement('link');
	// set the attributes for link element 
	link.rel = 'stylesheet'; 
	link.type = 'text/css';
	link.href = './assignment6.css?v='+ new Date().getTime(); 
	// Append link element to HTML head
	head.appendChild(link); 
	/* DO NOT EDIT THIS CODE- WRITTERN TO PREVENT CSS CACHING */	  
</script> 
</html>
